<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><title>XML source view</title><link rel="stylesheet" type="text/css" href="../xmlverbatim.css"></link></head><body class="xmlverb-default"><tt>
<!-- converted by xmlverbatim.xsl 1.1, (c) O. Becker -->
<div xmlns:xd="http://www.pnp-software.com/XSLTdoc" class="xmlverb-default">&lt;!--<span class="xmlverb-comment"><br></br>
    *  Copyright (C) 2008<br></br>
    *  Christoph Lange<br></br>
    *  KWARC, Jacobs University Bremen<br></br>
    *  http://kwarc.info/projects/krextor/<br></br>
    *<br></br>
    *   Krextor is free software; you can redistribute it and/or<br></br>
    *         modify it under the terms of the GNU Lesser General Public<br></br>
    *         License as published by the Free Software Foundation; either<br></br>
    *         version 2 of the License, or (at your option) any later version.<br></br>
    *<br></br>
    *         This program is distributed in the hope that it will be useful,<br></br>
    *         but WITHOUT ANY WARRANTY; without even the implied warranty of<br></br>
    *         MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU<br></br>
    *         Lesser General Public License for more details.<br></br>
    *<br></br>
    *         You should have received a copy of the GNU Lesser General Public<br></br>
    *         License along with this library; if not, write to the<br></br>
    *         Free Software Foundation, Inc., 59 Temple Place - Suite 330,<br></br>
    *         Boston, MA 02111-1307, USA.<br></br>
    * <br></br>
</span>--&gt;<br></br>
&lt;<span class="xmlverb-element-name"><a name="d70e2">stylesheet</a></span><span class="xmlverb-ns-name"> xmlns:f</span>="<span class="xmlverb-ns-uri">http://fxsl.sf.net/</span>"<span class="xmlverb-ns-name"> xmlns</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/XSL/Transform</span>"<span class="xmlverb-ns-name"> xmlns:xs</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2001/XMLSchema</span>"<span class="xmlverb-ns-name"> xmlns:xd</span>="<span class="xmlverb-ns-uri">http://www.pnp-software.com/XSLTdoc</span>"<span class="xmlverb-ns-name"> xmlns:krextor</span>="<span class="xmlverb-ns-uri">http://kwarc.info/projects/krextor</span>"<span class="xmlverb-ns-name"> xmlns:xi</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2001/XInclude</span>" <span class="xmlverb-attr-name">xpath-default-namespace</span>="<span class="xmlverb-attr-content">http://www.w3.org/1999/XSL/Transform</span>" <span class="xmlverb-attr-name">exclude-result-prefixes</span>="<span class="xmlverb-attr-content">#all</span>" <span class="xmlverb-attr-name">version</span>="<span class="xmlverb-attr-content">2.0</span>"&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e4">import</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">uri.xsl</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e6">doc</a></span> <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">stylesheet</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e8">short</a></span>&gt;<span class="xmlverb-text">Convenience functions and templates for extracting RDF from XML languages, independent both from the XML input language and from the RDF output notation</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e11">detail</a></span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e13">p</a></span>&gt;<span class="xmlverb-text">This stylesheet provides convenience functions and templates for an RDF extraction from XML languages.  It is independent of any RDF output notation.</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e17">author</a></span>&gt;<span class="xmlverb-text">Christoph Lange</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">author</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e20">copyright</a></span>&gt;<span class="xmlverb-text">Christoph Lange, 2008</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">copyright</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e23">svnId</a></span>&gt;<span class="xmlverb-text">$Id: generic.xsl 2048 2012-01-03 14:17:12Z clange $</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">svnId</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
<br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e27">include</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">../extract/util/rdf-xml.xsl</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e29">doc</a></span>&gt;<span class="xmlverb-text">Enable debug output?</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e32">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">debug</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e35">doc</a></span>&gt;<span class="xmlverb-text">Configures whether XIncludes should be traversed.  Note that templates for nodes in XIncluded documents are matched in </span>&lt;<span class="xmlverb-element-name"><a name="d70e37">code</a></span>&gt;<span class="xmlverb-text">krextor:included</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> mode.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e41">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">traverse-xincludes</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">true()</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e43">doc</a></span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e45">short</a></span>&gt;<span class="xmlverb-text">Points to an RDF/XML document whose data should be merged with the data extracted from the current input</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e48">detail</a></span>&gt;<span class="xmlverb-text">Replacing the </span>&lt;<span class="xmlverb-element-name"><a name="d70e50">code</a></span>&gt;<span class="xmlverb-text">merge-url-pattern-match</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> regular expression in the URI of the input XML document by the </span>&lt;<span class="xmlverb-element-name"><a name="d70e53">code</a></span>&gt;<span class="xmlverb-text">merge-url-pattern-replace</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> replacement pattern points to an RDF/XML document whose data should be merged with the data extracted from the current input.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e58">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">merge-url-pattern-match</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">''</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e60">doc</a></span>&gt;<span class="xmlverb-text">see </span>&lt;<span class="xmlverb-element-name"><a name="d70e62">code</a></span>&gt;<span class="xmlverb-text">merge-url-pattern-match</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e65">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">merge-url-pattern-replace</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">''</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e68">doc</a></span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e70">short</a></span>&gt;<span class="xmlverb-text">Defines a simple mapping of XML elements to ontology classes</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e73">detail</a></span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e75">p</a></span>&gt;<span class="xmlverb-text">Defines a simple mapping of XML elements to ontology classes.  This mapping is applied to all XML elements that are processed in </span>&lt;<span class="xmlverb-element-name"><a name="d70e77">code</a></span>&gt;<span class="xmlverb-text">krextor:create-resource</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> mode.</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e81">p</a></span>&gt;<span class="xmlverb-text">XML elements are given literally inside the XML value of this variable – mind the namespaces!  For each element, the following details may be provided as attributes:</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e84">ul</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e86">li</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d70e87">code</a></span>&gt;<span class="xmlverb-text">@type</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> – a whitespace-separated list of URIs of types of this resource; see the </span>&lt;<span class="xmlverb-element-name"><a name="d70e90">code</a></span>&gt;<span class="xmlverb-text">type</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> parameter of </span>&lt;<span class="xmlverb-element-name"><a name="d70e93">code</a></span>&gt;<span class="xmlverb-text">krextor:create-resource</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> for details</span>&lt;/<span class="xmlverb-element-name">li</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e97">li</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d70e98">code</a></span>&gt;<span class="xmlverb-text">@related-via-properties</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> – a whitespace-separated list of URIs of properties by which the parent resource is related to this resource; see the </span>&lt;<span class="xmlverb-element-name"><a name="d70e101">code</a></span>&gt;<span class="xmlverb-text">related-via-properties</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> parameter of </span>&lt;<span class="xmlverb-element-name"><a name="d70e104">code</a></span>&gt;<span class="xmlverb-text">krextor:create-resource</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> for details</span>&lt;/<span class="xmlverb-element-name">li</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e108">li</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d70e109">code</a></span>&gt;<span class="xmlverb-text">@related-via-inverse-properties</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> – a whitespace-separated list of URIs of properties by which this resource is related to the parent resource; see the </span>&lt;<span class="xmlverb-element-name"><a name="d70e112">code</a></span>&gt;<span class="xmlverb-text">related-via-inverse-properties</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> parameter of </span>&lt;<span class="xmlverb-element-name"><a name="d70e115">code</a></span>&gt;<span class="xmlverb-text">krextor:create-resource</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> for details</span>&lt;/<span class="xmlverb-element-name">li</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">ul</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e122">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:resources</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element()*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e124">doc</a></span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e126">short</a></span>&gt;<span class="xmlverb-text">Defines a simple mapping of XML (child) elements or attributes to ontology properties.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e129">detail</a></span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e131">p</a></span>&gt;<span class="xmlverb-text">Defines a simple mapping of XML (child) elements or attributes to ontology properties.  This mapping is applied to all XML elements or attributes that are processed in </span>&lt;<span class="xmlverb-element-name"><a name="d70e133">code</a></span>&gt;<span class="xmlverb-text">krextor:add-literal-property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> mode.</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e137">p</a></span>&gt;<span class="xmlverb-text">Elements are given literally inside the XML value of this variable – mind the namespaces!   Attributes are given as elements that are named after the attribute and carry an additional </span>&lt;<span class="xmlverb-element-name"><a name="d70e139">code</a></span>&gt;<span class="xmlverb-text">krextor:attribute="yes"</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> attribute.  For each property, the following details may be provided as attributes:</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e143">ul</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e145">li</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d70e146">code</a></span>&gt;<span class="xmlverb-text">@property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> – a whitespace-separated list of URIs of properties; see the </span>&lt;<span class="xmlverb-element-name"><a name="d70e149">code</a></span>&gt;<span class="xmlverb-text">property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> parameter of </span>&lt;<span class="xmlverb-element-name"><a name="d70e152">code</a></span>&gt;<span class="xmlverb-text">krextor:add-literal-property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> for details</span>&lt;/<span class="xmlverb-element-name">li</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e156">li</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d70e157">code</a></span>&gt;<span class="xmlverb-text">@object-is-list</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> – </span>&lt;<span class="xmlverb-element-name"><a name="d70e160">code</a></span>&gt;<span class="xmlverb-text">true</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> if the object is to be interpreted as a whitespace-separated list of multiple objects; see the </span>&lt;<span class="xmlverb-element-name"><a name="d70e163">code</a></span>&gt;<span class="xmlverb-text">object-is-list</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> parameter of </span>&lt;<span class="xmlverb-element-name"><a name="d70e166">code</a></span>&gt;<span class="xmlverb-text">krextor:add-literal-property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> for details</span>&lt;/<span class="xmlverb-element-name">li</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e170">li</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d70e171">code</a></span>&gt;<span class="xmlverb-text">@normalize-space</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> – </span>&lt;<span class="xmlverb-element-name"><a name="d70e174">code</a></span>&gt;<span class="xmlverb-text">true</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> if whitespace around the object is to be normalized; see the </span>&lt;<span class="xmlverb-element-name"><a name="d70e177">code</a></span>&gt;<span class="xmlverb-text">property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> parameter of </span>&lt;<span class="xmlverb-element-name"><a name="d70e180">code</a></span>&gt;<span class="xmlverb-text">krextor:add-literal-property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> for details</span>&lt;/<span class="xmlverb-element-name">li</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e184">li</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d70e185">code</a></span>&gt;<span class="xmlverb-text">@datatype</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> – the URI of the datatype of the object; see the </span>&lt;<span class="xmlverb-element-name"><a name="d70e188">code</a></span>&gt;<span class="xmlverb-text">property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> parameter of </span>&lt;<span class="xmlverb-element-name"><a name="d70e191">code</a></span>&gt;<span class="xmlverb-text">krextor:add-literal-property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> for details</span>&lt;/<span class="xmlverb-element-name">li</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">ul</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e196">p</a></span>&gt;<span class="xmlverb-text">The object value is taken from the text or XML content of the element or attribute, i.e. in the same way as when calling the </span>&lt;<span class="xmlverb-element-name"><a name="d70e198">code</a></span>&gt;<span class="xmlverb-text">krextor:add-literal-property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> template without an </span>&lt;<span class="xmlverb-element-name"><a name="d70e201">code</a></span>&gt;<span class="xmlverb-text">object</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> parameter.</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e206">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:literal-properties</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element()*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" /&gt;<span class="xmlverb-text"><br></br>
    <br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e208">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:uri-properties</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element()*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e210">doc</a></span>&gt;<span class="xmlverb-text">Checks whether a given node is a text node, an attribute, or an atomic value</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e214">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:is-text-or-attribute-or-atomic</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> can be of almost any type </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e218">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e220">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$node instance of xs:anyAtomicType or $node instance of text() or $node instance of attribute()</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e223">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:is-single-element</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e225">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">maybe-node</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e227">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$maybe-node instance of node() and $maybe-node/self::document-node() and count($maybe-node/node()) eq 1 and $maybe-node/node()/self::element()</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e230">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:normalize-if-single-element</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e232">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">maybe-node</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e234">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if (krextor:is-single-element($maybe-node)) then $maybe-node/node()/self::element() else $maybe-node</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e237">doc</a></span>&gt;<span class="xmlverb-text"><br></br>
      </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e239">short</a></span>&gt;<span class="xmlverb-text">Calls the output module template that outputs one RDF triple</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
      </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e242">detail</a></span>&gt;<span class="xmlverb-text">Calls the output module template that outputs one RDF triple.  URIs are resolved against the base URI before, if there is a base<br></br>
        URI.<br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e244">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>"&gt;<span class="xmlverb-text">the identifier of the subject, either a URI or a blank node ID</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e247">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-type</span>"&gt;<span class="xmlverb-text">the type of the subject identifier, either </span>&lt;<span class="xmlverb-element-name"><a name="d70e249">code</a></span>&gt;<span class="xmlverb-text">'uri'</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> or </span>&lt;<span class="xmlverb-element-name"><a name="d70e252">code</a></span>&gt;<span class="xmlverb-text">'blank'</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e255">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">predicate</span>"&gt;<span class="xmlverb-text">the identifier of the predicate, always a URI</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e258">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>"&gt;<span class="xmlverb-text">the value of the object, either a URI or a blank node ID or a literal</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e261">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-type</span>"&gt;<span class="xmlverb-text">the type of the object, either </span>&lt;<span class="xmlverb-element-name"><a name="d70e263">code</a></span>&gt;<span class="xmlverb-text">'uri'</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> or </span>&lt;<span class="xmlverb-element-name"><a name="d70e266">code</a></span>&gt;<span class="xmlverb-text">'blank'</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">, or nothing for literal objects.  A literal can be given as a string (or text node), or as any other XML</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e271">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-language</span>"&gt;<span class="xmlverb-text">the language of a literal object.  Language annotation is only supported on the object,<br></br>
             but neither on triples nor on graphs, as in RXR</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e274">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-datatype</span>"&gt;<span class="xmlverb-text">the datatype of a literal object</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e277">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:base-uri</span>"&gt;<span class="xmlverb-text">a static base URI (as, e.g., defined by </span>&lt;<span class="xmlverb-element-name"><a name="d70e279">code</a></span>&gt;<span class="xmlverb-text">base/@href</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> in XHTML), against which every URL is resolved</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
      </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e285">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:output-triple-impl</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e287">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">required</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e289">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-type</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'uri'</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e291">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">predicate</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" <span class="xmlverb-attr-name">required</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e293">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">required</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e295">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-type</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">''</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e298">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-language</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e300">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-datatype</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e302">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:base-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;!--<span class="xmlverb-comment"> uncomment for debugging:<br></br>
        &lt;message&gt;NEW RDF TRIPLE&lt;/message&gt;<br></br>
        &lt;message&gt;subject = &lt;value-of select="$subject"/&gt;&lt;/message&gt;<br></br>
        &lt;message&gt;subject-type = &lt;value-of select="$subject-type"/&gt;&lt;/message&gt;<br></br>
        &lt;message&gt;predicate = &lt;value-of select="$predicate"/&gt;&lt;/message&gt;<br></br>
        &lt;message&gt;object = &lt;value-of select="$object"/&gt;&lt;/message&gt;<br></br>
        &lt;message&gt;object-type = &lt;value-of select="$object-type"/&gt;&lt;/message&gt;<br></br>
        &lt;message&gt;object-language = &lt;value-of select="$object-language"/&gt;&lt;/message&gt;<br></br>
        &lt;message&gt;object-datatype = &lt;value-of select="$object-datatype"/&gt;&lt;/message&gt;<br></br>
        &lt;message&gt;krextor:base-uri = &lt;value-of select="$krextor:base-uri"/&gt;&lt;/message&gt;<br></br>
        </span>--&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;!--<span class="xmlverb-comment"> Some sanity checks </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e308">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">not($subject-type = ('uri', 'blank'))</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e310">message</a></span> <span class="xmlverb-attr-name">terminate</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">concat('Invalid subject type: ', $subject-type)</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e314">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">not($object-type = ('uri', 'blank', ''))</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e316">message</a></span> <span class="xmlverb-attr-name">terminate</span>="<span class="xmlverb-attr-content">yes</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">concat('Invalid object type: ', $subject-type)</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;!--<span class="xmlverb-comment"> Call the output module </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e321">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:output-triple</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e323">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($subject-type eq 'uri' and $krextor:base-uri) then resolve-uri($subject, $krextor:base-uri) else $subject</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e325">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$subject-type</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e327">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">predicate</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$predicate</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e329">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($object-type eq 'uri' and $krextor:base-uri) then resolve-uri($object, $krextor:base-uri) else krextor:preprocess-object-for-output($object)</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e331">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$object-type</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e334">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-language</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$object-language</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e336">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-datatype</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$object-datatype</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e340">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:preprocess-object-for-output</span>"&gt;<span class="xmlverb-text"><br></br>
       </span>&lt;<span class="xmlverb-element-name"><a name="d70e342">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" /&gt;<span class="xmlverb-text"><br></br>
       </span>&lt;<span class="xmlverb-element-name"><a name="d70e344">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:preprocess-object-for-output</span>"&gt;<span class="xmlverb-text"><br></br>
         </span>&lt;<span class="xmlverb-element-name"><a name="d70e346">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$object</span>" /&gt;<span class="xmlverb-text"><br></br>
       </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e351">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:preprocess-object-for-output</span>"&gt;<span class="xmlverb-text"><br></br>
       </span>&lt;<span class="xmlverb-element-name"><a name="d70e353">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" /&gt;<span class="xmlverb-text"><br></br>
       </span>&lt;<span class="xmlverb-element-name"><a name="d70e355">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$object</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e358">doc</a></span>&gt;<span class="xmlverb-text"><br></br>
      </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e360">short</a></span>&gt;<span class="xmlverb-text">Relates the current resource to its parent resource via some properties</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
      </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e363">detail</a></span>&gt;<span class="xmlverb-text">Relates the current resource to the "parent" resource, i.e. the nearest resource created from a template lower in the call stack, via some RDF properties or their inverses.<br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e365">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">properties</span>"&gt;<span class="xmlverb-text">a sequence of property URIs</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e368">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">inverse</span>"&gt;<span class="xmlverb-text">By default, this is </span>&lt;<span class="xmlverb-element-name"><a name="d70e370">code</a></span>&gt;<span class="xmlverb-text">false()</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">, and the relation is created in parent→current direction.  If this is set to </span>&lt;<span class="xmlverb-element-name"><a name="d70e373">code</a></span>&gt;<span class="xmlverb-text">true()</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">, the relation is created in inverse direction, i.e. current→parent.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
      </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e379">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:related-via-properties</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e381">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">properties</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e383">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">inverse</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;!--<span class="xmlverb-comment"> The identifier of the current resource </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e387">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e389">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generated-blank-node-id</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e392">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generated-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e394">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e396">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$blank-node</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e398">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:add-uri-property</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e400">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e402">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">inverse</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$inverse</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e404">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$generated-blank-node-id</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e408">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e410">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:add-uri-property</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e412">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e414">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">inverse</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$inverse</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e416">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$generated-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e422">doc</a></span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e424">short</a></span>&gt;<span class="xmlverb-text">Creates an RDF resource from the current element</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e427">detail</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d70e428">p</a></span>&gt;<span class="xmlverb-text">Creates an RDF resource of some type from the current<br></br>
                element, and probably creates related triples having this<br></br>
                resource as a subject or object.  Then, matching extraction<br></br>
                templates are applied to the child elements.  A call to<br></br>
                create-resource defines a scope in which the created resource<br></br>
                is the default subject of any other triple created using these<br></br>
                templates, unless another resource is created from some child<br></br>
                element.  The type (i.e. a URI of some class in some ontology)<br></br>
                has to be specified.</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e431">p</a></span>&gt;<span class="xmlverb-text">This resource is assumed the default subject of all triples<br></br>
                extracted from descendant elements and attributes using the<br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e433">code</a></span>&gt;<span class="xmlverb-text">krextor:add-literal-property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> and </span>&lt;<span class="xmlverb-element-name"><a name="d70e436">code</a></span>&gt;<span class="xmlverb-text">krextor:add-uri-property</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> templates.<br></br>
                Optionally, a sequence of properties can be passed by which<br></br>
                this resource is related to the “parent” resource, i.e. the resource created by the<br></br>
                invoking template (in most cases the resource created from the<br></br>
                parent XML element), or vice versa.  Additional properties of this resource<br></br>
                can be passed, if it is not possible to have them generated by<br></br>
                templates matching some attributes or children of this<br></br>
                element.</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e440">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e442">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>"&gt;<span class="xmlverb-text">a sequence of properties by which the parent resource is related to this resource</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e445">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-inverse-properties</span>"&gt;<span class="xmlverb-text">a sequence of properties by which this resource is related to its parent resource</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e448">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">type</span>"&gt;<span class="xmlverb-text">a sequence of URIs of types of the resource</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e452">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">properties</span>"&gt;<span class="xmlverb-text">additional properties of this resource, encoded as<br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e454">code</a></span>&gt;<span class="xmlverb-text">&amp;lt;krextor:property uri="property-uri+" object="object-uri"/&amp;gt;</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> or<br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e457">code</a></span>&gt;<span class="xmlverb-text">&amp;lt;krextor:property uri="property-uri+" value="object-literal"/&amp;gt;</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> or<br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e460">code</a></span>&gt;<span class="xmlverb-text">&amp;lt;krextor:property uri="property-uri+"&amp;gt;object-literal&amp;lt;/krextor:property&amp;gt;</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">.<br></br>
                On literal-valued objects, the attributes </span>&lt;<span class="xmlverb-element-name"><a name="d70e463">code</a></span>&gt;<span class="xmlverb-text">@language</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> and </span>&lt;<span class="xmlverb-element-name"><a name="d70e466">code</a></span>&gt;<span class="xmlverb-text">@datatype</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"><br></br>
                are also allowed.  Support for blank node objects is not yet implemented.<br></br>
                </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e470">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">process-next</span>"&gt;<span class="xmlverb-text">The node set to which further extraction templates are applied (via </span>&lt;<span class="xmlverb-element-name"><a name="d70e472">code</a></span>&gt;<span class="xmlverb-text">xsl:apply-templates</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">).  The default value is </span>&lt;<span class="xmlverb-element-name"><a name="d70e475">code</a></span>&gt;<span class="xmlverb-text">*|@*</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">, i.e. we also process attributes, as they may represent properties of the current resource.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e479">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e481">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node</span>"&gt;&lt;<span class="xmlverb-element-name"><a name="d70e482">code</a></span>&gt;<span class="xmlverb-text">true()</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> if this resource is a blank node</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e486">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">this-blank-node-id</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e488">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">collection</span>"&gt;&lt;<span class="xmlverb-element-name"><a name="d70e489">code</a></span>&gt;<span class="xmlverb-text">true()</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> if this resource is an RDF collection</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e495">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e497">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e499">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e501">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-inverse-properties</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e503">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string*</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e505">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">properties</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e508">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">process-next</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">*|@*</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> We pass the subject URI as a parameter into templates.  This is because we need to tweak the subject URI when processing transcluded documents; in this case, the transcluding document's URI should still be considered the subject URI, instead of the URI of the transcluded document. </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e512">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e514">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e516">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">this-blank-node-id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e518">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">collection</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e521">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">nested-call</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e523">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">autogenerate-fragment-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:uri-generation-method(.)</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> If we are to autogenerate the URI for this node, then we call the krextor:generate-uri function to generate one, unless an explicit subject URI has been passed<br></br>
          </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e527">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generated-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($blank-node) then xs:anyURI($subject-uri) else if (exists($subject)) then xs:anyURI($subject) else if (exists($autogenerate-fragment-uri)) then krextor:generate-uri(., $autogenerate-fragment-uri, xs:anyURI($subject-uri)) else xs:anyURI($subject-uri)</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e529">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generated-blank-node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$blank-node or $collection</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> TODO introduce auto-blank node if no xml:id given<br></br>
             if auto-blank-node isn't desired, skip elements without xml:id altogether </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e534">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generated-blank-node-id</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($generated-blank-node) then concat(if ($collection and not(starts-with($this-blank-node-id, 'collection-'))) then 'collection-' else '', if ($this-blank-node-id) then $this-blank-node-id else generate-id()) else ''</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e536">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($generated-blank-node) then $generated-blank-node-id else $generated-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e538">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-type</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($generated-blank-node) then 'blank' else 'uri'</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e540">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">exists($generated-uri)</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e542">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$nested-call</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> Relate this resource to its parent, if it has a parent </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> not(parent::node() instance of document-node()) would not work,<br></br>
                     as we may have document nodes synthesized by the extraction module </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e548">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:related-via-properties</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e550">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$related-via-properties</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e552">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$generated-blank-node</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e554">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generated-blank-node-id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$generated-blank-node-id</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e556">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generated-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$generated-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e559">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:related-via-properties</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e561">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$related-via-inverse-properties</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e563">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">inverse</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">true()</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e565">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$generated-blank-node</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e567">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generated-blank-node-id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$generated-blank-node-id</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e569">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">generated-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$generated-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
            </span>&lt;!--<span class="xmlverb-comment"> Create the triple(s) that instantiates this resource </span>--&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e575">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$type</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e577">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:output-triple-impl</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e579">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$subject</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e581">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$subject-type</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e583">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">predicate</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">xs:anyURI('http://www.w3.org/1999/02/22-rdf-syntax-ns#type')</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e585">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e587">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'uri'</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
            </span>&lt;!--<span class="xmlverb-comment"> Add additional properties to this resource </span>--&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e593">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$properties</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e595">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$properties/krextor:property[@uri]</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e597">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;&lt;!--<span class="xmlverb-comment"> save a reference for the inner for-each loop </span>--&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e600">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($property/@object) then $property/@object else if ($property/@value) then $property/@value else if ($property/node()) then $property/node() (: this covers text content and XML literals :) else ''</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e602">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$object</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e604">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tokenize($property/@uri, '\s+')</span>"&gt;<span class="xmlverb-text"><br></br>
                            </span>&lt;<span class="xmlverb-element-name"><a name="d70e606">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:output-triple-impl</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-name"><a name="d70e608">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$subject</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-name"><a name="d70e610">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$subject-type</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-name"><a name="d70e612">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">predicate</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">xs:anyURI(.)</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-name"><a name="d70e614">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$object</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-name"><a name="d70e616">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($property/@object) then 'uri' else ''</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-name"><a name="d70e619">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-language</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$property/@language</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-name"><a name="d70e621">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-datatype</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$property/@datatype</span>" /&gt;<span class="xmlverb-text"><br></br>
                            </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e629">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e631">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$collection</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e633">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-collection</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e635">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node-id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$generated-blank-node-id</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e637">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">rest</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$process-next</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e641">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;!--<span class="xmlverb-comment"> Process the children of this element, or whichever nodes desired </span>--&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e645">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$process-next</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:main</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> pass on the generated subject URI or blank node ID.  For resolving relative URIs, an appended fragment does<br></br>
                             not matter, but for generating property triples for this resource it does. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e649">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$generated-uri</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> Pass the information what type this is; this might help to disambiguate triple generation from children of the element that represents the resource of that type. </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e653">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$type</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e655">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node-id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$generated-blank-node-id</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> FIXME test whether it is sufficient to set this parameter just here </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e660">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">nested-call</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">true()</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;/<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e667">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:dummy-node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(krextor:dummy-node)</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name"><a name="d70e669">dummy-node</a></span> /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e673">doc</a></span>&gt;<span class="xmlverb-text">applies Krextor templates to a given node (usually one that has been synthesized, i.e. that does not exist in the input XML, but is needed to achieve a structure that better matches the desired RDF)</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e676">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:apply-templates</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e678">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.|@*</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> when processing a single synthesized element (which is complex content according to http://www.w3.org/TR/xslt20/#constructing-complex-content), it usually does not make sense to let Krextor process the document node </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e682">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">skip-document-node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">true()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e684">apply-templates</a></span> <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:main</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($skip-document-node) then $node/*[1] else $node</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e687">doc</a></span>&gt;<span class="xmlverb-text">we hope that this slightly speeds up search</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e690">key</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:resources</span>" <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">*</span>" <span class="xmlverb-attr-name">use</span>="<span class="xmlverb-attr-content">resolve-QName(name(), .)</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e692">doc</a></span>&gt;<span class="xmlverb-text">Creates a resource from an element for which a mapping to an ontology class has been declared in the variable </span>&lt;<span class="xmlverb-element-name"><a name="d70e694">code</a></span>&gt;<span class="xmlverb-text">krextor:resources</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e698">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">*</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e700">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e702">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">not(empty($krextor:resources))</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> variant without key: compare local-name and namespace-uri </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e706">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mapping</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element()</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">key('krextor:resources', resolve-QName(name(), .), if (not(empty($krextor:resources))) then $krextor:resources else $krextor:dummy-node)</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> we need this to trap the pre-computation of the key hashes </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e710">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e712">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tokenize($mapping/@type, '\s+')</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e714">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tokenize($mapping/@related-via-properties, '\s+')</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e716">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-inverse-properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tokenize($mapping/@related-via-inverse-properties, '\s+')</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e720">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e722">message</a></span> <span class="xmlverb-attr-name">terminate</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text">No mappings from XML elements to resources declared</span>&lt;/<span class="xmlverb-element-name">message</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e729">doc</a></span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e731">short</a></span>&gt;<span class="xmlverb-text">Adds a literal-valued property to the current resource</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e734">detail</a></span>&gt;<span class="xmlverb-text">Adds a literal-valued property to the resource in whose<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e736">code</a></span>&gt;<span class="xmlverb-text">krextor:create-resource</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> scope this template was called.<br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e739">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e741">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node-id</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e743">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>"&gt;<span class="xmlverb-text">a sequence of property URIs</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e746">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">tunneled-property</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e749">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>"&gt;<span class="xmlverb-text">the string value (a.k.a. “lexical form”) of the object.  If not specified, the text or XML content of the current element is taken for the object value.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e752">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-is-list</span>"&gt;&lt;<span class="xmlverb-element-name"><a name="d70e753">code</a></span>&gt;<span class="xmlverb-text">true()</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> if the object is to be interpreted as a whitespace-separated list or sequence of multiple objects.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e757">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">normalize-space</span>"&gt;&lt;<span class="xmlverb-element-name"><a name="d70e758">code</a></span>&gt;<span class="xmlverb-text">true()</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> if whitespace around the object value is to be normalized</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e762">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">language</span>"&gt;<span class="xmlverb-text">the language tag of a plain literal object</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e765">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">datatype</span>"&gt;<span class="xmlverb-text">the URI of the datatype of the object</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e770">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:add-literal-property</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e772">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e774">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node-id</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e776">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string*</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> property from incomplete triples </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e780">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">tunneled-property</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI*</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e783">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e785">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e787">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">element()</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e789">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">node()</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e792">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e794">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e799">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-is-list</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e801">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">normalize-space</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e803">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">language</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">''</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e805">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">datatype</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($object/self::element() or krextor:is-single-element($object)) then 'http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral' else ''</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e807">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">actual-property</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI+</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if (exists($property)) then for $p in $property return xs:anyURI($p) else $tunneled-property</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e810">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;!--<span class="xmlverb-comment"> If the "object" is a whitespace-separated list or a sequence of actual objects, we recursively generate one triple for each object. </span>--&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e814">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$object-is-list</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e816">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if (count($object) gt 0) then $object else tokenize($object, '\s+')</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e818">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:add-literal-property</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e820">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$actual-property</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e822">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;!--<span class="xmlverb-comment"> Make sure that we don't run into an infinite loop ;-) </span>--&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e826">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-is-list</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e831">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e833">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$actual-property</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e835">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:output-triple-impl</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e837">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($blank-node-id) then $blank-node-id else $subject-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e839">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($blank-node-id) then 'blank' else 'uri'</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e841">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">predicate</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e843">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($normalize-space) then normalize-space($object) else krextor:normalize-if-single-element($object)</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e845">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-language</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$language</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e848">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-datatype</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$datatype</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text">    <br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e855">doc</a></span>&gt;<span class="xmlverb-text">we hope that this slightly speeds up search</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e858">key</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:literal-properties</span>" <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">*</span>" <span class="xmlverb-attr-name">use</span>="<span class="xmlverb-attr-content">resolve-QName(name(), .)</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e860">doc</a></span>&gt;<span class="xmlverb-text">Creates a literal property from a child element or attribute for which a mapping to an ontology property has been declared in the variable </span>&lt;<span class="xmlverb-element-name"><a name="d70e862">code</a></span>&gt;<span class="xmlverb-text">krextor:literal-properties</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e866">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">*|@*</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:add-literal-property</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e868">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e870">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">not(empty($krextor:literal-properties))</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> variant without key: compare local-name and namespace-uri </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e874">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mapping</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element()</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">key('krextor:literal-properties', resolve-QName(name(), if (. instance of attribute()) then parent::node() else .), if (not(empty($krextor:literal-properties))) then $krextor:literal-properties else $krextor:dummy-node)</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> we need this to trap the pre-computation of the key hashes </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e878">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">. instance of attribute() and not($mapping/@krextor:attribute)</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e880">message</a></span> <span class="xmlverb-attr-name">terminate</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text">No mapping to a literal property found for attribute </span>&lt;<span class="xmlverb-element-name"><a name="d70e882">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;&lt;/<span class="xmlverb-element-name">message</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e885">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:add-literal-property</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e887">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tokenize($mapping/@property, '\s+')</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e889">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-is-list</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">boolean($mapping/@list)</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e891">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">normalize-space</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">boolean($mapping/@normalize-space)</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e893">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">datatype</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$mapping/@datatype</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e897">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e899">message</a></span> <span class="xmlverb-attr-name">terminate</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text">No mappings from XML to literal properties declared</span>&lt;/<span class="xmlverb-element-name">message</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e906">doc</a></span>&gt;<span class="xmlverb-text">Adds a URI-valued property to the resource in whose<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e908">code</a></span>&gt;<span class="xmlverb-text">create-resource</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> scope this template was called.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e912">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:add-uri-property</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e914">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e916">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node-id</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e918">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string*</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> property from incomplete triples </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e922">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">tunneled-property</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI*</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> Should the property be applied in inverse direction? </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e927">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">inverse</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> inverse information from incomplete triples </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e931">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">tunneled-inverse</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> Is the object a whitespace-separated list or a <br></br>
        multi-element sequence?  Use the empty sequence () instead<br></br>
        of the empty string in order to pass something that is not an object </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e935">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-is-list</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> Is the object an IRI that should first be converted to a URI?  Note that this is frequently the case in HTML. </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e940">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">iri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> Currently we assume that, if no explicit link target is given, we are either:<br></br>
        1. in the root element R of an XIncluded document and that a relationship between the parent of the xi:include and the XIncluded document is to be expressed.<br></br>
        2. or we are in an attribute or a text node or any item of a whitespace-separated list,<br></br>
           and a relationship between the current subject URI and the URIref in the attribute value is to be expressed. </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e944">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if (krextor:is-text-or-attribute-or-atomic(.)) then if ($object-is-list) then . else krextor:resolve-uri( if ($iri) then xs:anyURI(iri-to-uri(.)) else ., $subject-uri) (: What is this resolution good for? MMT? Anyway, if needed, we could also resolve each list item by for - in - return :) else if (parent::node() instance of document-node()) then krextor:base-uri(.) else ''</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> node ID, if the object is a blank node </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e948">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e950">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">($blank or exists($object)) and (exists($property) or exists($tunneled-property))</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e952">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">actual-object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($blank) then $blank else $object</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e954">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">actual-property</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI+</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if (exists($property)) then for $p in $property return xs:anyURI($p) else $tunneled-property</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e956">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">actual-inverse</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if (exists($property)) then $inverse else $tunneled-inverse</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e958">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> If the "object" is a whitespace-separated list of actual objects, we recursively generate one triple for each object. </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e962">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$object-is-list</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e964">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if (count($actual-object) gt 1) then $actual-object else tokenize($actual-object, '\s+')</span>"&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e966">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:add-uri-property</span>"&gt;<span class="xmlverb-text"><br></br>
                            </span>&lt;<span class="xmlverb-element-name"><a name="d70e968">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$actual-property</span>" /&gt;<span class="xmlverb-text"><br></br>
                            </span>&lt;<span class="xmlverb-element-name"><a name="d70e970">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">inverse</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$actual-inverse</span>" /&gt;<span class="xmlverb-text"><br></br>
                            </span>&lt;!--<span class="xmlverb-comment"> Make sure that we don't run into an infinite loop ;-) </span>--&gt;<span class="xmlverb-text"><br></br>
                            </span>&lt;<span class="xmlverb-element-name"><a name="d70e974">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-is-list</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" /&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;/<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e979">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e981">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e983">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$actual-inverse</span>"&gt;<span class="xmlverb-text"><br></br>
                            </span>&lt;<span class="xmlverb-element-name"><a name="d70e985">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$actual-property</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-name"><a name="d70e987">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:output-triple-impl</span>"&gt;<span class="xmlverb-text"><br></br>
                                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e989">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$actual-object</span>" /&gt;<span class="xmlverb-text"><br></br>
                                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e991">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($blank) then 'blank' else 'uri'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e993">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">predicate</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e995">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($blank-node-id) then $blank-node-id else $subject-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
                                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e997">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($blank-node-id) then 'blank' else 'uri'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                            </span>&lt;/<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1002">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1004">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$actual-property</span>"&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;<span class="xmlverb-element-name"><a name="d70e1006">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:output-triple-impl</span>"&gt;<span class="xmlverb-text"><br></br>
                                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1008">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($blank-node-id) then $blank-node-id else $subject-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
                                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1010">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($blank-node-id) then 'blank' else 'uri'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1012">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">predicate</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br></br>
                                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1014">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$actual-object</span>" /&gt;<span class="xmlverb-text"><br></br>
                                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1016">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($blank) then 'blank' else 'uri'</span>" /&gt;<span class="xmlverb-text"><br></br>
                                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
                            </span>&lt;/<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br></br>
                        </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text">    <br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e1026">doc</a></span>&gt;<span class="xmlverb-text">we hope that this slightly speeds up search</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1029">key</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:uri-properties</span>" <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">*</span>" <span class="xmlverb-attr-name">use</span>="<span class="xmlverb-attr-content">resolve-QName(name(), .)</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e1031">doc</a></span>&gt;<span class="xmlverb-text">Creates a URI-valued property from a child element or attribute for which a mapping to an ontology property has been declared in the variable </span>&lt;<span class="xmlverb-element-name"><a name="d70e1033">code</a></span>&gt;<span class="xmlverb-text">krextor:uri-properties</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1037">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">*|@*</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:add-uri-property</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1039">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1041">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">not(empty($krextor:uri-properties))</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> variant without key: compare local-name and namespace-uri </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e1045">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mapping</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element()</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">key('krextor:uri-properties', resolve-QName(name(), if (. instance of attribute()) then parent::node() else .), if (not(empty($krextor:uri-properties))) then $krextor:uri-properties else $krextor:dummy-node)</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;!--<span class="xmlverb-comment"> we need this to trap the pre-computation of the key hashes </span>--&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e1049">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">. instance of attribute() and not($mapping/@krextor:attribute)</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1051">message</a></span> <span class="xmlverb-attr-name">terminate</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text">No mapping to a URI-valued property found for attribute </span>&lt;<span class="xmlverb-element-name"><a name="d70e1053">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;&lt;/<span class="xmlverb-element-name">message</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e1056">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:add-uri-property</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1058">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">tokenize($mapping/@property, '\s+')</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1060">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">inverse</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">boolean($mapping/@inverse)</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1062">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object-is-list</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">boolean($mapping/@list)</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1064">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">iri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">boolean($mapping/@iri)</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1068">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e1070">message</a></span> <span class="xmlverb-attr-name">terminate</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text">No mappings from XML to URI-valued properties declared</span>&lt;/<span class="xmlverb-element-name">message</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e1077">doc</a></span>&gt;<span class="xmlverb-text">Creates a property whose values are added by nested template calls</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1080">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-property</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1082">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI+</span>" <span class="xmlverb-attr-name">required</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1084">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">inverse</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> The node set to which apply-templates is applied </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> We also process attributes, as they may contain links to other resources </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1090">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">process-next</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">*|@*</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1093">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$process-next</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:main</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1095">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">tunneled-property</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$property</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1097">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">tunneled-inverse</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$inverse</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e1101">doc</a></span>&gt;<span class="xmlverb-text">Creates an rdf Collection</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1104">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-collection</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1106">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">rest</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element()*</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1108">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node-id</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1110">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">collection-id</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1112">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">collection-index</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:integer</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">1</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1114">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">new-collection-id</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if (exists($collection-id)) then $collection-id else $blank-node-id</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1117">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">concat($new-collection-id, '-', $collection-index)</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1119">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$rest[1]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:main</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;!--<span class="xmlverb-comment"> if a resource is created from the first element, make it the first resource of this collection </span>--&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1123">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'http://www.w3.org/1999/02/22-rdf-syntax-ns#first'</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text">            <br></br>
            <br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1126">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1128">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$rest[2]</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e1130">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1132">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">this-blank-node-id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$subject</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1134">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'http://www.w3.org/1999/02/22-rdf-syntax-ns#rest'</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1136">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">collection</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">true()</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1138">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">process-next</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$rest[position() ge 2]</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1140">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">collection-id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$new-collection-id</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1143">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">collection-index</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$collection-index + 1</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1147">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e1149">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1151">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">xs:anyURI('http://www.w3.org/1999/02/22-rdf-syntax-ns#nil')</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1153">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'http://www.w3.org/1999/02/22-rdf-syntax-ns#rest'</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1155">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">process-next</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e1161">doc</a></span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e1163">short</a></span>&gt;<span class="xmlverb-text">Follows an XInclude (generally supported by Krextor)</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e1166">detail</a></span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1168">p</a></span>&gt;<span class="xmlverb-text">Krextor supports the following generic inclusion mechanism for XML documents: A root element R of a transcluded documents will be treated like a direct child of the parent element P of the xi:include element.  If there is a relevant relationship between P and R, an according triple is generated, with the transcluded document's URI (not the URI of R!) being the object.  The transcluded document is loaded and its root node examined in order to find this out.  Any relationships between elements of the transcluding document and the transcluded document that are not direct relationships between P and R are not considered during RDF extraction.</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1171">p</a></span>&gt;<span class="xmlverb-text">Note: We're using XInclude because the semantics of &amp;lt;element xlink:type="simple" xlink:show="embed" xlink:href="some-XML-resource"/&amp;gt; is not yet clearly defined in the XLink specification.  Should the root element of the document pointed to replace the pointing element, or should it be transcluded into the pointing element as a child?</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1176">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">xi:include</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:main</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1178">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$traverse-xincludes</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1180">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">document(@href, .)</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:included</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e1182">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:parent-element</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e1188">doc</a></span>&gt;<span class="xmlverb-text">Process the root element of an XIncluded document</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1191">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">/</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:included</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1193">apply-templates</a></span> <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:included</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e1196">doc</a></span>&gt;<span class="xmlverb-text">Start processing in default mode; we switch to Krextor's main mode first</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1199">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">/</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1201">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">/</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:main</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e1204">doc</a></span>&gt;<span class="xmlverb-text">Start processing; the current subject is identified by the base URI of the document.  Afterwards, if the </span>&lt;<span class="xmlverb-element-name"><a name="d70e1206">code</a></span>&gt;<span class="xmlverb-text">merge-url-pattern-*</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> parameters have been set, output the triples in the document at the URL obtained from the base URI of the current input after replacing </span>&lt;<span class="xmlverb-element-name"><a name="d70e1209">code</a></span>&gt;<span class="xmlverb-text">merge-url-pattern-match</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> with </span>&lt;<span class="xmlverb-element-name"><a name="d70e1212">code</a></span>&gt;<span class="xmlverb-text">merge-url-pattern-replace</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">.  In terms of the RDF semantics that means that those triples will be merged with the triples extracted from the primary input.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1216">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">/</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:main</span>" <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:main</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1218">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:base-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:base-uri(.)</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1220">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">merging-rdf</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$merge-url-pattern-match != ''</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1222">apply-templates</a></span> <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:main</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1224">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">xs:anyURI($krextor:base-uri)</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1226">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:base-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">xs:anyURI($krextor:base-uri)</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1229">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$merging-rdf</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;!--<span class="xmlverb-comment"> we need to run it in this mode instead of krextor:main, as otherwise certain output modules would see another document node and thus create a second RDF graph </span>--&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;!--<span class="xmlverb-comment"> we are not reusing the rewritten base URI ($krextor:base-uri()), as the objective here is to get access to a physical file, whereas the rewritten base URI is about serving nice cool URIs </span>--&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1235">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">merge-url</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">replace(base-uri(), $merge-url-pattern-match, $merge-url-pattern-replace)</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d70e1237">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">doc-available($merge-url)</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d70e1239">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">document($merge-url)</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:merge-rdf</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;!--<span class="xmlverb-comment"> avoid infinite loop </span>--&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1243">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">merging-rdf</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1250">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">/</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:merge-rdf</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d70e1252">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:main</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d70e1255">doc</a></span>&gt;<span class="xmlverb-text">Do not extract RDF from attributes that are not matched by the<br></br>
        language-specific templates, nor from text nodes (same for all Krextor modes).</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d70e1258">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">@*|text()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:main</span>" /&gt;<span class="xmlverb-text"><br></br>
</span>&lt;/<span class="xmlverb-element-name">stylesheet</span>&gt;<br></br>
&lt;!--<span class="xmlverb-comment"><br></br>
Local Variables:<br></br>
mode: nxml<br></br>
nxml-child-indent: 4<br></br>
End:<br></br>
</span>--&gt;<br></br>
</div>
</tt><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br>v
         </body></html>
