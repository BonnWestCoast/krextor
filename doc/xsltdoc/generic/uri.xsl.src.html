<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><title>XML source view</title><link rel="stylesheet" type="text/css" href="../xmlverbatim.css"></link></head><body class="xmlverb-default"><tt>
<!-- converted by xmlverbatim.xsl 1.1, (c) O. Becker -->
<div xmlns:xd="http://www.pnp-software.com/XSLTdoc" class="xmlverb-default">&lt;!--<span class="xmlverb-comment"><br></br>
    *  Copyright (C) 2008<br></br>
    *  Christoph Lange<br></br>
    *  KWARC, Jacobs University Bremen<br></br>
    *  http://kwarc.info/projects/krextor/<br></br>
    *<br></br>
    *   Krextor is free software; you can redistribute it and/or<br></br>
    *         modify it under the terms of the GNU Lesser General Public<br></br>
    *         License as published by the Free Software Foundation; either<br></br>
    *         version 2 of the License, or (at your option) any later version.<br></br>
    *<br></br>
    *         This program is distributed in the hope that it will be useful,<br></br>
    *         but WITHOUT ANY WARRANTY; without even the implied warranty of<br></br>
    *         MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU<br></br>
    *         Lesser General Public License for more details.<br></br>
    *<br></br>
    *         You should have received a copy of the GNU Lesser General Public<br></br>
    *         License along with this library; if not, write to the<br></br>
    *         Free Software Foundation, Inc., 59 Temple Place - Suite 330,<br></br>
    *         Boston, MA 02111-1307, USA.<br></br>
    * <br></br>
</span>--&gt;<br></br>
&lt;<span class="xmlverb-element-name"><a name="d49e2">stylesheet</a></span><span class="xmlverb-ns-name"> xmlns</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/XSL/Transform</span>"<span class="xmlverb-ns-name"> xmlns:krextor-genuri</span>="<span class="xmlverb-ns-uri">http://kwarc.info/projects/krextor/genuri</span>"<span class="xmlverb-ns-name"> xmlns:xs</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2001/XMLSchema</span>"<span class="xmlverb-ns-name"> xmlns:xd</span>="<span class="xmlverb-ns-uri">http://www.pnp-software.com/XSLTdoc</span>"<span class="xmlverb-ns-name"> xmlns:krextor</span>="<span class="xmlverb-ns-uri">http://kwarc.info/projects/krextor</span>"<span class="xmlverb-ns-name"> xmlns:f</span>="<span class="xmlverb-ns-uri">http://fxsl.sf.net/</span>" <span class="xmlverb-attr-name">xpath-default-namespace</span>="<span class="xmlverb-attr-content">http://www.w3.org/1999/XSL/Transform</span>" <span class="xmlverb-attr-name">exclude-result-prefixes</span>="<span class="xmlverb-attr-content">#all</span>" <span class="xmlverb-attr-name">version</span>="<span class="xmlverb-attr-content">2.0</span>"&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e4">import</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">util.xsl</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e6">doc</a></span> <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">stylesheet</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e8">short</a></span>&gt;<span class="xmlverb-text">Functions that generate URIs for resources found in documents</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e11">detail</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d49e12">p</a></span>&gt;<span class="xmlverb-text">This stylesheet provides functions and templates that generate URIs for resources found in documents</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e15">author</a></span>&gt;<span class="xmlverb-text">Christoph Lange</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">author</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e18">copyright</a></span>&gt;<span class="xmlverb-text">Christoph Lange, 2009</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">copyright</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e21">svnId</a></span>&gt;<span class="xmlverb-text">$Id: uri.xsl 866 2009-12-15 22:41:40Z clange $</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">svnId</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e25">doc</a></span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e27">short</a></span>&gt;<span class="xmlverb-text">Should URIs like </span>&lt;<span class="xmlverb-element-name"><a name="d49e29">code</a></span>&gt;<span class="xmlverb-text">document#fragment</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> automatically be<br></br>
            generated?  Sequence of string values out of </span>&lt;<span class="xmlverb-element-name"><a name="d49e32">code</a></span>&gt;<span class="xmlverb-text">xml-id</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">, </span>&lt;<span class="xmlverb-element-name"><a name="d49e35">code</a></span>&gt;<span class="xmlverb-text">document-root-base</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">, </span>&lt;<span class="xmlverb-element-name"><a name="d49e38">code</a></span>&gt;<span class="xmlverb-text">generate-id</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">, </span>&lt;<span class="xmlverb-element-name"><a name="d49e41">code</a></span>&gt;<span class="xmlverb-text">pseudo-xpath</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">, or additional custom values.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e45">detail</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d49e46">p</a></span>&gt;<span class="xmlverb-text">This parameter is a sequence of string values representing URI generation functions:</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d49e49">dl</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e51">dt</a></span>&gt;<span class="xmlverb-text">xml-id</span>&lt;/<span class="xmlverb-element-name">dt</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e54">dd</a></span>&gt;<span class="xmlverb-text">use the </span>&lt;<span class="xmlverb-element-name"><a name="d49e56">a</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">http://www.w3.org/TR/xml-id/</span>"&gt;<span class="xmlverb-text">xml:id</span>&lt;/<span class="xmlverb-element-name">a</span>&gt;<span class="xmlverb-text"> attribute if available, otherwise nothing</span>&lt;/<span class="xmlverb-element-name">dd</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e60">dt</a></span>&gt;<span class="xmlverb-text">document-root-base</span>&lt;/<span class="xmlverb-element-name">dt</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e63">dd</a></span>&gt;<span class="xmlverb-text">use the base URI if we are on the root element, otherwise nothing.  Note that for meaningful results you should not pass a manipulated base URI into </span>&lt;<span class="xmlverb-element-name"><a name="d49e65">code</a></span>&gt;<span class="xmlverb-text">create-resource</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">.</span>&lt;/<span class="xmlverb-element-name">dd</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e69">dt</a></span>&gt;<span class="xmlverb-text">generate-id</span>&lt;/<span class="xmlverb-element-name">dt</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e73">dd</a></span>&gt;<span class="xmlverb-text">generate via </span>&lt;<span class="xmlverb-element-name"><a name="d49e75">a</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">http://www.w3.org/TR/xslt20/#generate-id</span>"&gt;<span class="xmlverb-text">generate-id()</span>&lt;/<span class="xmlverb-element-name">a</span>&gt;<span class="xmlverb-text"> function (always succeeds)</span>&lt;/<span class="xmlverb-element-name">dd</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e79">dt</a></span>&gt;<span class="xmlverb-text">pseudo-xpath</span>&lt;/<span class="xmlverb-element-name">dt</span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e82">dd</a></span>&gt;<span class="xmlverb-text">generate an </span>&lt;<span class="xmlverb-element-name"><a name="d49e84">a</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">http://www.w3.org/TR/xpath20/</span>"&gt;<span class="xmlverb-text">XPath</span>&lt;/<span class="xmlverb-element-name">a</span>&gt;<span class="xmlverb-text">-like<br></br>
                    expression from the local names and local positions of the<br></br>
                    element and its parents (always succeeds; can lead to clashes<br></br>
                    if elements from different namespaces with the same local names<br></br>
                    are used in the same context or if dashes are used within<br></br>
                    element names; inefficient because the whole XPath<br></br>
                    from the root is newly computed for every element); example:<br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d49e87">code</a></span>&gt;<span class="xmlverb-text">doc-section2-para1</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> =<br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d49e90">code</a></span>&gt;<span class="xmlverb-text">/doc/section[2]/para[1]</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;&lt;/<span class="xmlverb-element-name">dd</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">dl</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d49e94">p</a></span>&gt;<span class="xmlverb-text">The default setting is </span>&lt;<span class="xmlverb-element-name"><a name="d49e96">code</a></span>&gt;<span class="xmlverb-text">('xml-id' 'document-root-base')</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">.<br></br>
                If one method fails to generate a URI, the next one in the list is<br></br>
                tried, until one succeeds; otherwise, no resource is created for<br></br>
                the respective node.</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d49e100">p</a></span>&gt;<span class="xmlverb-text">Note that there is no guarantee that </span>&lt;<span class="xmlverb-element-name"><a name="d49e102">code</a></span>&gt;<span class="xmlverb-text">generate-id</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> and<br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e105">code</a></span>&gt;<span class="xmlverb-text">pseudo-xpath</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> generate URIs that differ from all </span>&lt;<span class="xmlverb-element-name"><a name="d49e108">a</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">http://www.w3.org/TR/xml-id/</span>"&gt;<span class="xmlverb-text">xml:id</span>&lt;/<span class="xmlverb-element-name">a</span>&gt;<span class="xmlverb-text">s in the<br></br>
                document.  We leave the responsibility of not creating too obscure<br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e111">code</a></span>&gt;<span class="xmlverb-text">xml:id</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">s to the document author.</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d49e115">p</a></span>&gt;<span class="xmlverb-text">Also note that any fragment ID that the base URI of the document<br></br>
                already has is discarded and replaced by the generated fragment ID,<br></br>
                if Krextor is instructed to generate one.  More than one fragment<br></br>
                is not allowed by the </span>&lt;<span class="xmlverb-element-name"><a name="d49e117">a</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">http://www.faqs.org/rfcs/rfc3986.html</span>"&gt;<span class="xmlverb-text">URI RFC 3986</span>&lt;/<span class="xmlverb-element-name">a</span>&gt;<span class="xmlverb-text">.<br></br>
                See </span>&lt;<span class="xmlverb-element-name"><a name="d49e120">a</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">http://www.aifb.uni-karlsruhe.de/pipermail/swikig/2006-February/000095.html</span>"&gt;<span class="xmlverb-text">this<br></br>
                    e-mail thread from the Semantic Wiki mailing list</span>&lt;/<span class="xmlverb-element-name">a</span>&gt;<span class="xmlverb-text"> for more<br></br>
                background on this in a semantic web context.</span>&lt;/<span class="xmlverb-element-name">p</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">detail</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e126">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">autogenerate-fragment-uris</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'xml-id', 'document-root-base'</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e128">doc</a></span>&gt;<span class="xmlverb-text">Configures whether relative URIs should be resolved into absolute URIs when generating URIs for resources.  Setting it to </span>&lt;<span class="xmlverb-element-name"><a name="d49e130">code</a></span>&gt;<span class="xmlverb-text">false</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> is experimental.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e135">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">resolve-relative-uris</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">true()</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e137">doc</a></span>&gt;<span class="xmlverb-text">Resolves a relative URI against a base URI, if URI resolution is globally turned on.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e140">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:resolve-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e142">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">relative</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e144">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e146">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($resolve-relative-uris) then resolve-uri($relative, $base) else $relative</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e149">doc</a></span>&gt;<span class="xmlverb-text">Controls whether URIs of resources are rewritten from an internal<br></br>
        representation into an external representation (which will be visible<br></br>
        in the extracted RDF).  If set to false (default), the internal URIs of<br></br>
        the input XML documents will also be used in the RDF output.  If true,<br></br>
        any URI that is part of the output RDF will be rewritten.  The way how<br></br>
        URIs are rewritten is determined by the implementation of the<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e151">code</a></span>&gt;<span class="xmlverb-text">krextor:external-uri</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> template in scope.  This module<br></br>
        provides a default implementation that performs a regular expression<br></br>
        replacement, based on the parameters<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e154">code</a></span>&gt;<span class="xmlverb-text">document-uri-pattern-match</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> and<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e157">code</a></span>&gt;<span class="xmlverb-text">document-uri-pattern-replace</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">.  In the interest of the </span>&lt;<span class="xmlverb-element-name"><a name="d49e160">a</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">http://www.w3.org/DesignIssues/LinkedData.html</span>"&gt;<span class="xmlverb-text">linked data<br></br>
            conventions</span>&lt;/<span class="xmlverb-element-name">a</span>&gt;<span class="xmlverb-text">, the external URIs should be retrievable URLs<br></br>
        (pointing to downloadable versions of the original XML<br></br>
        documents).</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e164">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">rewrite-document-uris</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'false'</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e166">doc</a></span>&gt;<span class="xmlverb-text">Internal parameter holding the value of </span>&lt;<span class="xmlverb-element-name"><a name="d49e168">code</a></span>&gt;<span class="xmlverb-text">rewrite-document-uris</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">, converted to a boolean</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e173">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">rewrite-document-uris-boolean</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$rewrite-document-uris eq 'true'</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e175">doc</a></span>&gt;<span class="xmlverb-text">Rewrites an internal into an external URI if the parameter </span>&lt;<span class="xmlverb-element-name"><a name="d49e177">code</a></span>&gt;<span class="xmlverb-text">rewrite-document-uris</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> is set to </span>&lt;<span class="xmlverb-element-name"><a name="d49e180">code</a></span>&gt;<span class="xmlverb-text">true</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">.  The actual implementation is provided by a template of the same name.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e184">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:external-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e186">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">internal-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e188">choose</a></span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d49e190">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$rewrite-document-uris-boolean</span>"&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e192">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:external-uri</span>"&gt;<span class="xmlverb-text"><br></br>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d49e194">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">internal-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$internal-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d49e198">otherwise</a></span>&gt;<span class="xmlverb-text"><br></br>
                </span>&lt;<span class="xmlverb-element-name"><a name="d49e200">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$internal-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e205">doc</a></span>&gt;<span class="xmlverb-text">A regular expression pattern that is matched against any URI to be rewritten by the built-in default implementation of the </span>&lt;<span class="xmlverb-element-name"><a name="d49e207">code</a></span>&gt;<span class="xmlverb-text">krextor:external-uri</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> template</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e211">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">document-uri-pattern-match</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e213">doc</a></span>&gt;<span class="xmlverb-text">A replacement string (possibly including backreferences to substrings matched by </span>&lt;<span class="xmlverb-element-name"><a name="d49e215">code</a></span>&gt;<span class="xmlverb-text">document-uri-pattern-match</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">) that controls how URIs are rewritten by the built-in default implementation of the </span>&lt;<span class="xmlverb-element-name"><a name="d49e218">code</a></span>&gt;<span class="xmlverb-text">krextor:external-uri</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> template</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e223">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">document-uri-pattern-replace</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" /&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e225">doc</a></span>&gt;<span class="xmlverb-text">Default implementation of the same-named function.  Rewrites an internal into an external URI by a string replacement according to the<br></br>
        settings of the parameters </span>&lt;<span class="xmlverb-element-name"><a name="d49e227">code</a></span>&gt;<span class="xmlverb-text">document-uri-pattern-match</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> and<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e230">code</a></span>&gt;<span class="xmlverb-text">document-uri-pattern-replace</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">.<br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e234">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:external-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e236">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">internal-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e238">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">xs:anyURI( replace($internal-uri, $document-uri-pattern-match, $document-uri-pattern-replace))</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e241">doc</a></span>&gt;<span class="xmlverb-text">Returns the base URI of the given node, after URI rewriting, if rewriting is enabled via the </span>&lt;<span class="xmlverb-element-name"><a name="d49e243">code</a></span>&gt;<span class="xmlverb-text">rewrite-document-uris</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> parameter.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e247">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:base-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e249">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e251">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:external-uri(base-uri($node))</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e254">doc</a></span>&gt;<span class="xmlverb-text">Generates a URI for a fragment of a document; returns the empty<br></br>
        sequence if the fragment ID is empty.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e258">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:fragment-uri-or-null</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI?</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e260">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">fragment-id</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e262">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e264">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($fragment-id) then krextor:resolve-uri(concat('#', $fragment-id), $base-uri) else ()</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e267">doc</a></span>&gt;<span class="xmlverb-text">creates an XPath-like string from the path to a node, <br></br>
        e.g. </span>&lt;<span class="xmlverb-element-name"><a name="d49e269">code</a></span>&gt;<span class="xmlverb-text">doc-sect1-para2</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> for </span>&lt;<span class="xmlverb-element-name"><a name="d49e272">code</a></span>&gt;<span class="xmlverb-text">/doc/sect[1]/para[2]</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e275">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:pseudo-xpath</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e277">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> TODO maybe also for attribute nodes? </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e281">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($node/parent::node() instance of document-node()) then local-name($node) else concat( krextor:pseudo-xpath($node/parent::node()), '-', local-name($node), count($node/preceding-sibling::node()) + 1 )</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e284">doc</a></span>&gt;<span class="xmlverb-text">Generates a URI for a resource using the default generation method</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e287">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:generate-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e289">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e291">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e293">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:generate-uri($node, krextor:uri-generation-method($node), $base-uri)</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e296">doc</a></span>&gt;<span class="xmlverb-text">Generates a URI for a resource</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e300">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:generate-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI?</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e302">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e304">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">autogenerate-fragment-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string*</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e306">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;!--<span class="xmlverb-comment"> What we'd actually like to do is applying a series of _functions_<br></br>
        to ($node, $base-uri), but that doesn't work.  It would involve<br></br>
        currying, and the FXSL implementation of currying breaks nodes in XML<br></br>
        documents </span>--&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e310">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">f:return-first(krextor:generate-uri-impl(), $autogenerate-fragment-uri, ($node, $base-uri))</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e313">doc</a></span>&gt;<span class="xmlverb-text">Generates a URI for a given node, using a given base URI as appropriate, using the given method<br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e315">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">method</span>" <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">string</span>"&gt;<span class="xmlverb-text">the identifier of the URI generation method</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e318">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">params</span>"&gt;<span class="xmlverb-text">a two-item sequence (</span>&lt;<span class="xmlverb-element-name"><a name="d49e320">code</a></span>&gt;<span class="xmlverb-text">node</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">, </span>&lt;<span class="xmlverb-element-name"><a name="d49e323">code</a></span>&gt;<span class="xmlverb-text">base-uri</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">)</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;!--<span class="xmlverb-comment"> Altova XML reports XTTE0780<br></br>
    &lt;function name="krextor:generate-uri-impl" as="xs:anyURI?"&gt;<br></br>
    </span>--&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e330">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:generate-uri-impl</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e332">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">method</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e334">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">params</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">item()+</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e336">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$params[1]</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e338">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$params[2]</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e340">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">method-element</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element()</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d49e342">element</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">{concat('krextor-genuri:', $method)}</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e346">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$method-element</span>"&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d49e348">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$node</span>" /&gt;<span class="xmlverb-text"><br></br>
            </span>&lt;<span class="xmlverb-element-name"><a name="d49e350">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$base-uri</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;/<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e354">doc</a></span>&gt;<span class="xmlverb-text">Returns the base URI of the document for the root node,<br></br>
        otherwise the empty sequence.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e357">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">krextor-genuri:document-root-base</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e359">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e361">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e363">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($node/parent::node() instance of document-node()) then $base-uri else ()</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e367">doc</a></span>&gt;<span class="xmlverb-text">Common implementation of the </span>&lt;<span class="xmlverb-element-name"><a name="d49e369">code</a></span>&gt;<span class="xmlverb-text">xml-id</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">, </span>&lt;<span class="xmlverb-element-name"><a name="d49e372">code</a></span>&gt;<span class="xmlverb-text">generate-id</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> and </span>&lt;<span class="xmlverb-element-name"><a name="d49e375">code</a></span>&gt;<span class="xmlverb-text">pseudo-xpath</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> URI generation functions.  They all use the given base URI and append a fragment ID; they differ in how the fragment ID is generated.  The base URI is generally assumed to be the URI of the document that contains the given node.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e379">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">krextor-genuri:xml-id|krextor-genuri:generate-id|krextor-genuri:pseudo-xpath</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e381">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e383">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e385">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:fragment-uri-or-null( if (self::krextor-genuri:xml-id and $node/@xml:id) then $node/@xml:id else if (self::krextor-genuri:generate-id) then generate-id($node) else if (self::krextor-genuri:pseudo-xpath) then krextor:pseudo-xpath($node) else (), $base-uri)</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e388">doc</a></span>&gt;<span class="xmlverb-text">Returns an FXSL reference to the<br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e390">code</a></span>&gt;<span class="xmlverb-text">krextor:generate-uri-impl</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> function.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e394">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:generate-uri-impl</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(krextor:generate-uri-impl)</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name"><a name="d49e396">generate-uri-impl</a></span> /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e399">doc</a></span>&gt;<span class="xmlverb-text">FXSL template representing the two-argument </span>&lt;<span class="xmlverb-element-name"><a name="d49e401">code</a></span>&gt;<span class="xmlverb-text">krextor:generate-uri-impl</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> function</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e405">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">krextor:generate-uri-impl</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:anyURI?</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">f:FXSL</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e407">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">arg1</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e409">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">arg2</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">item()+</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e411">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:generate-uri-impl($arg1, $arg2)</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e415">doc</a></span>&gt;<span class="xmlverb-text">Returns the method in which a URI will be generated for the current node unless a different explicit subject URI is passed to </span>&lt;<span class="xmlverb-element-name"><a name="d49e417">code</a></span>&gt;<span class="xmlverb-text">krextor:create-resource</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">; extraction modules can override this.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e421">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">node()</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:uri-generation-method</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e423">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$autogenerate-fragment-uris</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br></br>
<br></br>
    </span><div class="xd">
    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d49e426">doc</a></span>&gt;<span class="xmlverb-text">Returns the method in which a URI will be generated for the given node unless a different explicit subject URI is passed to </span>&lt;<span class="xmlverb-element-name"><a name="d49e428">code</a></span>&gt;<span class="xmlverb-text">krextor:create-resource</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">; this calls the template running in the namesake mode.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br></br>
    </span>&lt;<span class="xmlverb-element-name"><a name="d49e432">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:uri-generation-method</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string*</span>"&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e434">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>" /&gt;<span class="xmlverb-text"><br></br>
        </span>&lt;<span class="xmlverb-element-name"><a name="d49e436">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$node</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:uri-generation-method</span>" /&gt;<span class="xmlverb-text"><br></br>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br></br>
</span>&lt;/<span class="xmlverb-element-name">stylesheet</span>&gt;<br></br>
</div>
</tt><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br><br></br>v
         </body></html>
