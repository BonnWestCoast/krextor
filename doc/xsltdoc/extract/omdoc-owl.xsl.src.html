
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><title>XML source view</title><link rel="stylesheet" type="text/css" href="../xmlverbatim.css"/></head><body class="xmlverb-default"><tt>
<!-- converted by xmlverbatim.xsl 1.1, (c) O. Becker -->
<div xmlns:xd="http://www.pnp-software.com/XSLTdoc" class="xmlverb-default">&lt;!--<span class="xmlverb-comment"><br/>
    *  Copyright (C) 2008<br/>
    *  Christoph Lange<br/>
    *  KWARC, Jacobs University Bremen<br/>
    *  http://kwarc.info/projects/krextor/<br/>
    *<br/>
    *   Krextor is free software; you can redistribute it and/or<br/>
    *         modify it under the terms of the GNU Lesser General Public<br/>
    *         License as published by the Free Software Foundation; either<br/>
    *         version 2 of the License, or (at your option) any later version.<br/>
    *<br/>
    *         This program is distributed in the hope that it will be useful,<br/>
    *         but WITHOUT ANY WARRANTY; without even the implied warranty of<br/>
    *         MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU<br/>
    *         Lesser General Public License for more details.<br/>
    *<br/>
    *         You should have received a copy of the GNU Lesser General Public<br/>
    *         License along with this library; if not, write to the<br/>
    *         Free Software Foundation, Inc., 59 Temple Place - Suite 330,<br/>
    *         Boston, MA 02111-1307, USA.<br/>
    * <br/>
</span>--&gt;<br/>
&lt;<span class="xmlverb-element-name"><a name="d25e2">stylesheet</a></span><span class="xmlverb-ns-name"> xmlns</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/XSL/Transform</span>"<span class="xmlverb-ns-name"> xmlns:om</span>="<span class="xmlverb-ns-uri">http://www.openmath.org/OpenMath</span>"<span class="xmlverb-ns-name"> xmlns:krextor-genuri</span>="<span class="xmlverb-ns-uri">http://kwarc.info/projects/krextor/genuri</span>"<span class="xmlverb-ns-name"> xmlns:xs</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2001/XMLSchema</span>"<span class="xmlverb-ns-name"> xmlns:odo</span>="<span class="xmlverb-ns-uri">http://www.omdoc.org/ontology#</span>"<span class="xmlverb-ns-name"> xmlns:omdoc</span>="<span class="xmlverb-ns-uri">http://omdoc.org/ns</span>"<span class="xmlverb-ns-name"> xmlns:krextor</span>="<span class="xmlverb-ns-uri">http://kwarc.info/projects/krextor</span>"<span class="xmlverb-ns-name"> xmlns:xd</span>="<span class="xmlverb-ns-uri">http://www.pnp-software.com/XSLTdoc</span>"<span class="xmlverb-ns-name"> xmlns:f</span>="<span class="xmlverb-ns-uri">http://fxsl.sf.net/</span>" <span class="xmlverb-attr-name">xpath-default-namespace</span>="<span class="xmlverb-attr-content">http://omdoc.org/ns</span>" <span class="xmlverb-attr-name">exclude-result-prefixes</span>="<span class="xmlverb-attr-content">#all</span>" <span class="xmlverb-attr-name">version</span>="<span class="xmlverb-attr-content">2.0</span>"&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e4">import</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">util/omdoc.xsl</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e6">doc</a></span> <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">stylesheet</span>"&gt;<span class="xmlverb-text"><br/>
        Extracts </span>&lt;<span class="xmlverb-element-name"><a name="d25e8">a</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">http://www.w3.org/2004/OWL/</span>"&gt;<span class="xmlverb-text">OWL</span>&lt;/<span class="xmlverb-element-name">a</span>&gt;<span class="xmlverb-text"> ontologies from </span>&lt;<span class="xmlverb-element-name"><a name="d25e11">a</a></span> <span class="xmlverb-attr-name">href</span>="<span class="xmlverb-attr-content">http://www.omdoc.org</span>"&gt;<span class="xmlverb-text">OMDoc</span>&lt;/<span class="xmlverb-element-name">a</span>&gt;<span class="xmlverb-text"> documents by giving them a special interpretation<br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e14">author</a></span>&gt;<span class="xmlverb-text">Christoph Lange</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">author</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e17">copyright</a></span>&gt;<span class="xmlverb-text">Christoph Lange, 2008</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">copyright</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e20">svnId</a></span>&gt;<span class="xmlverb-text">$Id: omdoc-owl.xsl 723 2009-08-05 11:15:04Z clange $</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">svnId</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e24">strip-space</a></span> <span class="xmlverb-attr-name">elements</span>="<span class="xmlverb-attr-content">*</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e26">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">debug</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">true()</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e28">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">autogenerate-fragment-uris</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e31">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:ontology-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e33">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e35">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">name</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e37">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">concat($base-uri, $name)</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e40">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">krextor-genuri:ontology</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e42">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e44">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e46">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri($base-uri, if ($node/self::theory) then '' else $node/@name)</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e49">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:mmt-uri</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e51">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e53">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">name</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e55">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">concat($base-uri, '?', $name)</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e58">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">krextor-genuri:mmt</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string?</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e60">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e62">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">node</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e64">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:mmt-uri($base-uri, $node/@name)</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e67">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-ontology-resource</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e69">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mmt</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e71">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e73">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e75">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">autogenerate-fragment-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($mmt) then ('mmt') else ('ontology')</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e77">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mmt</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$mmt</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e79">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$type</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e83">doc</a></span> <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">element*</span>"&gt;<span class="xmlverb-text">A sequence of mappings of CDs representing semantic web ontologies to their corresponding namespaces</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e87">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">ontology-namespaces</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;!--<span class="xmlverb-comment"> TODO do this on the ref-normal form of the document (cf. $all in exincl.xsl </span>--&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e91">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">/descendant::theory</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;!--<span class="xmlverb-comment"> We collect the set of distinct symbols in this theory, not regarding nested theories </span>--&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e95">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">cdus</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e97">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">descendant::om:OMS[ancestor::theory[1] is current() and not(ancestor::notation)]/@cd</span>" <span class="xmlverb-attr-name">group-by</span>="<span class="xmlverb-attr-content">.</span>"&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e99">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br/>
                </span>&lt;/<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;!--<span class="xmlverb-comment"> we determine those symbols whose symbol definition is not in this document </span>--&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e105">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">todo</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$cdus[not(. = /descendant::theory/@xml:id)]</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e107">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">catalogue</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;!--<span class="xmlverb-comment"> we search the import graph, starting with our theory. </span>--&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e111">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:make-catalogue</span>"&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e113">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">todo</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$todo</span>" /&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e115">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">theory</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" /&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e117">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">base-uri()</span>" /&gt;<span class="xmlverb-text"><br/>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
<br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e122">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$catalogue</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:post-process-catalogue</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e124">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">this-theory</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@xml:id</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e129">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">/</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:post-process-catalogue</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e131">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">this-theory</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name"><a name="d25e133">loc</a></span> <span class="xmlverb-attr-name">theory</span>="<span class="xmlverb-attr-content">{$this-theory}</span>" <span class="xmlverb-attr-name">omdoc</span>="<span class="xmlverb-attr-content">{concat('#', $this-theory)}</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e135">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sem-web-base</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:sem-web-base[not(preceding-sibling::*)]</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e137">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$sem-web-base</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e139">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sem-web-base</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$sem-web-base</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name">loc</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e143">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">* except krextor:sem-web-base[not(preceding-sibling::*)]</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">#current</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e146">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">krextor:loc</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:post-process-catalogue</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e148">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sem-web-base</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e150">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sem-web-base</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">following-sibling::krextor:sem-web-base[@omdoc eq current()/@omdoc]</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e152">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($sem-web-base) then $sem-web-base else if (not(following-sibling::krextor:visited[. eq current()/@omdoc])) then krextor:sem-web-base(document(@omdoc)) else ''</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e155">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$sem-web-base</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e157">copy</a></span>&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e159">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@*</span>" /&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e161">attribute</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sem-web-base</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$sem-web-base</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">copy</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e166">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">krextor:visited|krextor:sem-web-base</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">krextor:post-process-catalogue</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e168">doc</a></span>&gt;<span class="xmlverb-text">Recursively examine the locally imported theories and locate all theories that still need a catalogue entry.  Each theory is only visited once.  Returns a set of </span>&lt;<span class="xmlverb-element-name"><a name="d25e170">code</a></span>&gt;<span class="xmlverb-text">krextor:loc</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> elements.<br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e173">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">todo</span>"&gt;<span class="xmlverb-text">the theories that still need a catalogue entry</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e176">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">theory</span>"&gt;<span class="xmlverb-text">the theory that is searched for them</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e179">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>"&gt;<span class="xmlverb-text">the base URI of the current theory, against which links to imported theories are resolved</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e182">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">visited</span>"&gt;<span class="xmlverb-text">a set of theories already visited</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e186">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">top-level-call</span>" <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">boolean</span>"&gt;<span class="xmlverb-text">indicates whether this is a top-level or a recursive call</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e190">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:make-catalogue</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e192">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">todo</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e194">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">theory</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e196">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e198">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">visited</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">()</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e200">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">top-level-call</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">true()</span>" /&gt;<span class="xmlverb-text"><br/>
        <br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e203">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sem-web-base</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:sem-web-base($theory)</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e205">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$sem-web-base ne ''</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name"><a name="d25e207">sem-web-base</a></span> <span class="xmlverb-attr-name">omdoc</span>="<span class="xmlverb-attr-content">{concat(base-uri($theory), '#', $theory/@xml:id)}</span>"&gt;&lt;<span class="xmlverb-element-name"><a name="d25e208">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$sem-web-base</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name">sem-web-base</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
<br/>
        </span>&lt;!--<span class="xmlverb-comment"> We build the local catalogue and put it in  a variable </span>--&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e213">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">local-cat</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;!--<span class="xmlverb-comment"> search for imports in this theory.<br/>
            TODO Are we considering nested theories?  If so, we'd need to<br/>
            search their ancestors as well. </span>--&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e217">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$theory/imports</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name"><a name="d25e219">loc</a></span> <span class="xmlverb-attr-name">theory</span>="<span class="xmlverb-attr-content">{substring-after(@from, '#')}</span>" <span class="xmlverb-attr-name">omdoc</span>="<span class="xmlverb-attr-content">{resolve-uri(@from, $base-uri)}</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
<br/>
        </span>&lt;!--<span class="xmlverb-comment"> those theories that are in the local catalogue of the theory specified by the parameter $theory </span>--&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e225">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">incat</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$todo[. = $local-cat/krextor:loc/@theory]</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
        </span>&lt;!--<span class="xmlverb-comment"> ... and those that aren't </span>--&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e230">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">rest</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$todo except $incat</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
        </span>&lt;!--<span class="xmlverb-comment"> output loc elements for those theories that are imported from<br/>
        other documents and that were searched for (note, this <br/>
        differs from OMDoc's exincl.xsl) </span>--&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e234">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$local-cat/krextor:loc[@theory = $incat]</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
        </span>&lt;!--<span class="xmlverb-comment"> if there are remaining theories that are not in the local catalogue, recurse to them </span>--&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e238">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$rest</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e240">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">follow</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$local-cat/krextor:loc[not(@omdoc = $visited)]/@omdoc</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;!--<span class="xmlverb-comment"> there is a catalogue of locally imported, still unvisited theories we can follow </span>--&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e244">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$follow</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e246">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">result</span>"&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e248">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:make-catalogue-iteration</span>"&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e250">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">todo</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$rest</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e252">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">head</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$follow[1]</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e254">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">tail</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$follow[position() gt 1]</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e256">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$base-uri</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e258">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">visited</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$visited</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e261">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">top-level-call</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$top-level-call</span>" /&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
                </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
<br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e265">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$result</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e271">doc</a></span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e273">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">todo</span>"&gt;<span class="xmlverb-text">the theories that still need a catalogue entry</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e276">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">head</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e278">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">tail</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e280">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>"&gt;<span class="xmlverb-text">the base URI of the current theory, against which links to imported theories are resolved</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e283">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">visited</span>"&gt;<span class="xmlverb-text">a set of theories already visited</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e287">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">top-level-call</span>" <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">boolean</span>"&gt;<span class="xmlverb-text">indicates whether this is a top-level or a recursive call</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e291">template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:make-catalogue-iteration</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e293">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">todo</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e295">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">head</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e297">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">tail</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e299">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e301">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">visited</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e304">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">top-level-call</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e306">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">new-base-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">resolve-uri($head, $base-uri)</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e308">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">recursive-call</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;!--<span class="xmlverb-comment"> this generates a set of loc's, followed by a list of visited's </span>--&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e312">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:make-catalogue</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e314">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">todo</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$todo</span>" /&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e316">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">theory</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">document($head, .)</span>" /&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e318">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$new-base-uri</span>" /&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e320">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">visited</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$visited</span>" /&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e322">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">top-level-call</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">false()</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name"><a name="d25e325">visited</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d25e326">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$head</span>" /&gt;&lt;/<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name">visited</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
<br/>
        </span>&lt;!--<span class="xmlverb-comment"> output the output generated by the recursive call<br/>
             (loc, visited, and sem-web-base) </span>--&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e331">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$recursive-call</span>" /&gt;<span class="xmlverb-text"><br/>
        <br/>
        </span>&lt;!--<span class="xmlverb-comment"> prepare next iteration: search still unvisited theories for imports still not found </span>--&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e336">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">next-tail</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$tail[not(. = $recursive-call/krextor:visited)]</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e338">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">next-todo</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$todo[not(. = $recursive-call/krextor:loc/@theory)]</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
        </span>&lt;!--<span class="xmlverb-comment"> if there are imports to be found ... </span>--&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e342">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$next-todo</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e344">choose</a></span>&gt;<span class="xmlverb-text"><br/>
                </span>&lt;!--<span class="xmlverb-comment"> ... and unvisited theories to search for them ... </span>--&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e348">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$next-tail</span>"&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e350">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:make-catalogue-iteration</span>"&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e352">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">todo</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$next-todo</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e354">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">head</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$next-tail[1]</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e356">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">tail</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$next-tail[position() gt 1]</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e358">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">visited</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$visited|$recursive-call/visited</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e360">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">base-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$base-uri</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e363">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">top-level-call</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$top-level-call</span>" /&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
                </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e367">otherwise</a></span>&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e369">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$top-level-call</span>"&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e371">message</a></span> <span class="xmlverb-attr-name">terminate</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text">Cannot find locations for the theories </span>&lt;<span class="xmlverb-element-name"><a name="d25e373">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$next-todo</span>" <span class="xmlverb-attr-name">separator</span>="<span class="xmlverb-attr-content">,</span>" /&gt;<span class="xmlverb-text">!</span>&lt;/<span class="xmlverb-element-name">message</span>&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
                </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e381">doc</a></span>&gt;<span class="xmlverb-text">Overridden imported function from </span>&lt;<span class="xmlverb-element-name"><a name="d25e383">code</a></span>&gt;<span class="xmlverb-text">util/rdfa.xsl</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e386">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:default-curie-namespace</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e388">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">focus</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e390">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:default-namespace($focus)</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;!--<span class="xmlverb-comment"> regular templates matching OMDoc start here </span>--&gt;<span class="xmlverb-text"><br/>
    <br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e395">doc</a></span>&gt;<span class="xmlverb-text">Create a resource from an OMDoc symbol</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e399">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">symbol</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e401">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-ontology-resource</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e404">doc</a></span>&gt;<span class="xmlverb-text">Make this property an instance of some relation type</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e407">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">symbol/type/om:OMOBJ/om:OMA[krextor:is-ontology-term(.)] |symbol/type/om:OMOBJ[krextor:is-from-ontology(om:OMS[1])]</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e409">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">not(om:*[3] and om:OMS[1]/@cd eq 'rdf' and om:OMS[1]/@name eq 'Property')</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;!--<span class="xmlverb-comment"> When domain and range are given, the triple<br/>
                 X rdf:type rdf:Property<br/>
                 is redundant, as it is entailed by the RDFS axiomatic triples,<br/>
                 so we don't generate it. </span>--&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e413">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[1]</span>"&gt;<span class="xmlverb-text">                <br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e415">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'http://www.w3.org/1999/02/22-rdf-syntax-ns#type'</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e419">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">om:*[3]</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;!--<span class="xmlverb-comment"> Handle rdfs:domain and rdfs:range, but only if they are both given </span>--&gt;<span class="xmlverb-text"><br/>
            </span>&lt;!--<span class="xmlverb-comment"> Note that, in this case, we should actually enforce that om:*[1] is<br/>
                 rdf:Property or a subproperty thereof, but during this translation we<br/>
                 don't have access to a reasoner :-( </span>--&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e425">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[2]</span>"&gt;<span class="xmlverb-text">                <br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e427">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'http://www.w3.org/2000/01/rdf-schema#domain'</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e430">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[3]</span>"&gt;<span class="xmlverb-text">                <br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e432">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'http://www.w3.org/2000/01/rdf-schema#range'</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text">            <br/>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    <br/>
    </span>&lt;!--<span class="xmlverb-comment"> TODO implement syntactic sugar for rdfs:subClassOf and rdfs:subPropertyOf<br/>
         https://trac.kwarc.info/krextor/ticket/25<br/>
    </span>--&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e439">doc</a></span>&gt;<span class="xmlverb-text">Returns the semantic web URI of a given symbol<br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e441">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sym</span>"&gt;<span class="xmlverb-text">a symbol that is expected to have </span>&lt;<span class="xmlverb-element-name"><a name="d25e443">code</a></span>&gt;<span class="xmlverb-text">@cd</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> and </span>&lt;<span class="xmlverb-element-name"><a name="d25e446">code</a></span>&gt;<span class="xmlverb-text">@name</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> attributes (as in OpenMath)</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e451">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:ontology-uri</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e453">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sym</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e455">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sem-web-base</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ontology-namespaces/krextor:loc[@theory eq $sym/@cd][1]/@sem-web-base</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e457">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($sem-web-base) then krextor:ontology-uri($sem-web-base, $sym/@name) else krextor:mmt-uri('MMT-FIXME', concat($sym/@cd, '?', $sym/@name))</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e461">doc</a></span>&gt;<span class="xmlverb-text">Returns a semantic web URI for the given symbol, if the parameter is a symbol, otherwise the empty sequence.<br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e463">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sym</span>"&gt;<span class="xmlverb-text">a symbol that is expected to have </span>&lt;<span class="xmlverb-element-name"><a name="d25e465">code</a></span>&gt;<span class="xmlverb-text">@cd</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> and </span>&lt;<span class="xmlverb-element-name"><a name="d25e468">code</a></span>&gt;<span class="xmlverb-text">@name</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> attributes (as in OpenMath)</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e473">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:ontology-uri-or-blank</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e475">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sym</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e477">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($sym/self::om:OMS) then krextor:ontology-uri($sym) else ()</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
        <br/>
        <br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e480">doc</a></span>&gt;<span class="xmlverb-text">Returns </span>&lt;<span class="xmlverb-element-name"><a name="d25e482">code</a></span>&gt;<span class="xmlverb-text">true()</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> if the parameter is a symbol defined in an ontology.<br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e485">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sym</span>"&gt;<span class="xmlverb-text">a symbol that is expected to have </span>&lt;<span class="xmlverb-element-name"><a name="d25e487">code</a></span>&gt;<span class="xmlverb-text">@cd</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> and </span>&lt;<span class="xmlverb-element-name"><a name="d25e490">code</a></span>&gt;<span class="xmlverb-text">@name</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text"> attributes (as in OpenMath)</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e495">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:is-from-ontology</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e497">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sym</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e499">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">boolean($ontology-namespaces/krextor:loc[@theory eq $sym/@cd]/@sem-web-base)</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e502">doc</a></span>&gt;<span class="xmlverb-text">Returns whether the given term is an expression made in terms of an ontology<br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e504">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">term</span>"&gt;<span class="xmlverb-text">an OpenMath (sub)term whose topmost symbol (</span>&lt;<span class="xmlverb-element-name"><a name="d25e506">code</a></span>&gt;<span class="xmlverb-text">OMS</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">) is checked with </span>&lt;<span class="xmlverb-element-name"><a name="d25e509">code</a></span>&gt;<span class="xmlverb-text">krextor:is-from-ontology</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e513">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:is-ontology-term</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e515">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">term</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e517">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:is-from-ontology(($term/descendant::om:OMS)[1])</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e521">doc</a></span>&gt;<span class="xmlverb-text">Creates an RDF triple for a single OWL axiom given as a predicate(subject, object) triple</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e524">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">axiom/FMP/om:OMOBJ/om:OMA[count(om:*) eq 3 and krextor:is-ontology-term(.)]</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e526">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sym</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[1]</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e528">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">predicate-object-rewritten</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name"><a name="d25e530">dummy</a></span>&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-nsprefix">om</span>:<span class="xmlverb-element-name"><a name="d25e532">OMA</a></span>&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e534">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[1]</span>" /&gt;&lt;!--<span class="xmlverb-comment"> predicate </span>--&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e537">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[3]</span>" /&gt;&lt;!--<span class="xmlverb-comment"> object </span>--&gt;<span class="xmlverb-text"><br/>
                </span>&lt;/<span class="xmlverb-element-nsprefix">om</span>:<span class="xmlverb-element-name">OMA</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name">dummy</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e543">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;!--<span class="xmlverb-comment"> TODO automate this by overriding create-resource </span>--&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e547">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri-or-blank(om:*[2])</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e549">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">process-next</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[2][not(self::om:OMS)] |$predicate-object-rewritten/*</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e553">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">krextor:dummy/om:OMA[count(om:*) eq 2][om:*[1][self::om:OMS]]</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e555">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e557">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri(om:*[1])</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e559">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri-or-blank(om:*[2])</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e561">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">process-next</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[2][not(self::om:OMS)]</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e565">doc</a></span>&gt;<span class="xmlverb-text">Initiates the creation of a class definition</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e568">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">definition[@type eq 'simple' and krextor:is-ontology-term(om:OMOBJ)]</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e570">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">symbol</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">document(@for)</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e572">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$symbol</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;!--<span class="xmlverb-comment"> construct an OpenMath symbol </span>--&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e576">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">symbol-oms</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-nsprefix">om</span>:<span class="xmlverb-element-name"><a name="d25e578">OMS</a></span> <span class="xmlverb-attr-name">cd</span>="<span class="xmlverb-attr-content">{parent::theory/@xml:id}</span>" <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">{$symbol/@name}</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e581">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e583">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri($symbol-oms/om:OMS)</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e588">doc</a></span>&gt;<span class="xmlverb-text">Creates simple equivalence definitions (</span>&lt;<span class="xmlverb-element-name"><a name="d25e590">i</a></span>&gt;<span class="xmlverb-text">owl:equivalentClass</span>&lt;/<span class="xmlverb-element-name">i</span>&gt;<span class="xmlverb-text">, </span>&lt;<span class="xmlverb-element-name"><a name="d25e593">i</a></span>&gt;<span class="xmlverb-text">owl:equivalentProperty</span>&lt;/<span class="xmlverb-element-name">i</span>&gt;<span class="xmlverb-text">, </span>&lt;<span class="xmlverb-element-name"><a name="d25e596">i</a></span>&gt;<span class="xmlverb-text">owl:sameAs</span>&lt;/<span class="xmlverb-element-name">i</span>&gt;<span class="xmlverb-text">)</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e601">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">om:OMS[parent::om:OMOBJ[parent::definition[@type eq 'simple']]]</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e603">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">symbol-type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">document(parent::om:OMOBJ/parent::definition/@for)/type/om:OMOBJ/descendant::om:OMS[1]</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e605">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e607">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e609">choose</a></span>&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;!--<span class="xmlverb-comment"> so far, we assume that owl:Class is the only known class type </span>--&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e613">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$symbol-type/@cd eq 'owl' and $symbol-type/@name eq 'Class'</span>"&gt;<span class="xmlverb-text">http://www.w3.org/2002/07/owl#equivalentClass</span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;!--<span class="xmlverb-comment"> we recognize rdf:Property and owl:*Property as property types </span>--&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e618">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">($symbol-type/@cd eq 'rdf' and $symbol-type/@name eq 'Property') or ($symbol-type/@cd eq 'owl' and ends-with($symbol-type/@name, 'Property'))</span>"&gt;<span class="xmlverb-text">http://www.w3.org/2002/07/owl#equivalentProperty</span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;!--<span class="xmlverb-comment"> symbols of any other type, or without a type, are considered individuals </span>--&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e624">otherwise</a></span>&gt;<span class="xmlverb-text">http://www.w3.org/2002/07/owl#sameAs</span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
                </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">with-param</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e629">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri(.)</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
        </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e633">doc</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d25e634">i</a></span>&gt;<span class="xmlverb-text">owl:intersectionOf, owl:unionOf, owl:complementOf, owl:oneOf</span>&lt;/<span class="xmlverb-element-name">i</span>&gt;<span class="xmlverb-text"> constructor</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e638">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">om:OMA[om:*[1][self::om:OMS[@cd eq 'owl' and (@name = ('intersectionOf', 'complementOf', 'unionOf', 'oneOf')) ]]]</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e640">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e642">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri(om:*[1])</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e644">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">collection</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">true()</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e646">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">process-next</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[position() ge 2]</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e650">doc</a></span>&gt;&lt;<span class="xmlverb-element-name"><a name="d25e651">i</a></span>&gt;<span class="xmlverb-text">owl:Restriction</span>&lt;/<span class="xmlverb-element-name">i</span>&gt;<span class="xmlverb-text"> constructor</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;!--<span class="xmlverb-comment"> TODO formally specify this as an OMDoc axiom: https://trac.kwarc.info/krextor/ticket/27 </span>--&gt;<span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e657">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">om:OMA[count(om:*) eq 3][om:*[1][self::om:OMS[@cd eq 'owl' and @name eq 'Restriction']]][om:*[2][self::om:OMS]]</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e659">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e661">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'http://www.w3.org/2002/07/owl#Restriction'</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e663">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">properties</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-nsprefix">krextor</span>:<span class="xmlverb-element-name"><a name="d25e665">property</a></span> <span class="xmlverb-attr-name">uri</span>="<span class="xmlverb-attr-content">http://www.w3.org/2002/07/owl#onProperty</span>" <span class="xmlverb-attr-name">object</span>="<span class="xmlverb-attr-content">{krextor:ontology-uri(om:*[2])}</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">with-param</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e668">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">blank-node</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">true()</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e670">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">process-next</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[3]</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e675">doc</a></span>&gt;<span class="xmlverb-text">Sets the cardinality of a property restriction</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e678">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">om:OMA[om:*[1][self::om:OMS[@cd eq 'owl' and @name = ('minCardinality', 'maxCardinality', 'cardinality')]]][om:*[2][self::om:OMI]]</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e680">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:add-literal-property</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e682">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri(om:*[1])</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e684">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[2]/text()</span>" /&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e686">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">datatype</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'http://www.w3.org/2001/XMLSchema#nonNegativeInteger'</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
        <br/>
        </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e690">doc</a></span>&gt;<span class="xmlverb-text">Sets the allValuesFrom, someValuesFrom, hasValue of a property restriction</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e693">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">om:OMA[om:*[1][self::om:OMS[@cd eq 'owl' and @name = ('allValuesFrom', 'someValuesFrom', 'hasValue')]]][om:*[2][self::om:OMS]]</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e695">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e697">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">related-via-properties</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri(om:*[1])</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e699">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri(om:*[2])</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text">                        <br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e701">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">process-next</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[3]</span>" /&gt;<span class="xmlverb-text"><br/>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text">                <br/>
        </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
        <br/>
        </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e705">doc</a></span>&gt;<span class="xmlverb-text">Sets hasValue of a DataType property restriction</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e708">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">om:OMA[om:*[1][self::om:OMS[@cd eq 'owl' and @name = ('hasValue')]]][om:*[2][not(self::om:OMS)]]</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e710">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:add-literal-property</span>"&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e712">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">property</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri(om:*[1])</span>" /&gt;<span class="xmlverb-text"><br/>
                        </span>&lt;<span class="xmlverb-element-name"><a name="d25e714">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">object</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">om:*[2]/text()</span>" /&gt;<span class="xmlverb-text"><br/>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
        <br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e719">doc</a></span>&gt;<span class="xmlverb-text">Creates a resource from an individual symbol</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e722">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">om:OMS</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e724">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-resource</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e726">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">krextor:ontology-uri(.)</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e730">doc</a></span>&gt;<span class="xmlverb-text">Try to find the ontology namespace (calls </span>&lt;<span class="xmlverb-element-name"><a name="d25e732">code</a></span>&gt;<span class="xmlverb-text">krextor:sem-web-base</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">)</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e736">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">theory</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e738">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sem-web-base</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$ontology-namespaces/krextor:loc[@theory eq current()/@xml:id]/@sem-web-base</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e740">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'http://www.w3.org/2002/07/owl#Ontology'</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e742">choose</a></span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e744">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">exists($sem-web-base)</span>"&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e746">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-ontology-resource</span>"&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e748">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">subject-uri</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$sem-web-base</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e750">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$type</span>" /&gt;<span class="xmlverb-text"><br/>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e754">otherwise</a></span>&gt;<span class="xmlverb-text"><br/>
                </span>&lt;<span class="xmlverb-element-name"><a name="d25e756">call-template</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:create-ontology-resource</span>"&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e758">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mmt</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">true()</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
                    </span>&lt;<span class="xmlverb-element-name"><a name="d25e760">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">type</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$type</span>" /&gt;<span class="xmlverb-text"><br/>
                </span>&lt;/<span class="xmlverb-element-name">call-template</span>&gt;<span class="xmlverb-text"><br/>
            </span>&lt;/<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e766">doc</a></span>&gt;<span class="xmlverb-text">Try to find the ontology namespace of a given theory (special<br/>
        metadata field </span>&lt;<span class="xmlverb-element-name"><a name="d25e768">code</a></span>&gt;<span class="xmlverb-text">odo:semWebBase</span>&lt;/<span class="xmlverb-element-name">code</span>&gt;<span class="xmlverb-text">)<br/>
        </span>&lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e771">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">theory</span>" <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">node</span>"&gt;<span class="xmlverb-text">the theory</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">param</span>&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e775">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">krextor:sem-web-base</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e777">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">theory</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e779">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">link</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()*</span>"&gt;<span class="xmlverb-text"><br/>
            </span>&lt;<span class="xmlverb-element-name"><a name="d25e781">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$theory/metadata/link[krextor:curie-to-uri($theory, @rel) eq 'http://www.omdoc.org/ontology#semWebBase']</span>" /&gt;<span class="xmlverb-text"><br/>
        </span>&lt;/<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
        </span>&lt;<span class="xmlverb-element-name"><a name="d25e784">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($link) then $link/@href else ''</span>" /&gt;<span class="xmlverb-text"><br/>
    </span>&lt;/<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e788">doc</a></span>&gt;<span class="xmlverb-text">We don't extract top-level metadata, as they do not correspond to<br/>
        anything in an ontology.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e791">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">/omdoc/metadata</span>" /&gt;<span class="xmlverb-text"><br/>
<br/>
    </span><div class="xd">

    &lt;<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name"><a name="d25e793">doc</a></span>&gt;<span class="xmlverb-text">We don't extract the special annotation of the ontology namespace<br/>
        of a theory, as it is for internal use.</span>&lt;/<span class="xmlverb-element-nsprefix">xd</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
    </span>&lt;<span class="xmlverb-element-name"><a name="d25e796">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">link[krextor:curie-to-uri(., @rel) eq 'http://www.omdoc.org/ontology#semWebBase']</span>" /&gt;<span class="xmlverb-text"><br/>
</span>&lt;/<span class="xmlverb-element-name">stylesheet</span>&gt;<br/>
</div>
</tt><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>v
         </body></html>
